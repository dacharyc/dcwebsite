# Prevent Apache's MultiViews from serving index.html when index.md is requested
Options -MultiViews

RewriteEngine On

# Content negotiation: serve index.md when Accept header prefers text/markdown
RewriteCond %{HTTP_ACCEPT} text/markdown
RewriteCond %{REQUEST_FILENAME} -d
RewriteCond %{REQUEST_FILENAME}/index.md -f
RewriteRule ^(.*)$ $1/index.md [L,T=text/markdown]

RewriteCond %{HTTP_ACCEPT} text/markdown
RewriteCond %{REQUEST_FILENAME}.md -f
RewriteRule ^(.*)$ $1.md [L,T=text/markdown]

# Serve .md files with the correct content type
AddType text/markdown .md

# Cache headers for agent-facing resources: keep fresh for agents, allow revalidation
<FilesMatch "\.md$">
    Header set Cache-Control "max-age=3600, must-revalidate"
</FilesMatch>

<Files "llms.txt">
    Header set Cache-Control "max-age=3600, must-revalidate"
</Files>
